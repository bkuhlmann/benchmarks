#! /usr/bin/env ruby
# frozen_string_literal: true

require "bundler/inline"

gemfile true do
  source "https://rubygems.org"

  gem "benchmark-ips"
end

require "securerandom"

word = SecureRandom.alphanumeric 100
string_matcher = "a"
regex_matcher = /\Aa/

Benchmark.ips do |benchmark|
  benchmark.config time: 5, warmup: 2

  benchmark.report("#match?") { word.match? regex_matcher }
  benchmark.report("#=~") { word =~ regex_matcher }
  benchmark.report("#start_with? (String)") { word.start_with? string_matcher }
  benchmark.report("#start_with? (Regex)") { word.start_with? regex_matcher }
  benchmark.report("#end_with?") { word.end_with? string_matcher }

  benchmark.compare!
end

__END__

ruby 3.3.0 (2023-12-25 revision 5124f9ac75) +YJIT [arm64-darwin22.6.0]
Warming up --------------------------------------
             #match?     1.557M i/100ms
                 #=~   640.701k i/100ms
#start_with? (String)
                         1.805M i/100ms
#start_with? (Regex)   592.021k i/100ms
          #end_with?     1.812M i/100ms
Calculating -------------------------------------
             #match?     23.231M (± 0.5%) i/s -    116.739M in   5.025282s
                 #=~      7.508M (± 0.5%) i/s -     37.801M in   5.035199s
#start_with? (String)
                         28.097M (± 0.4%) i/s -    140.817M in   5.011989s
#start_with? (Regex)      6.710M (± 3.2%) i/s -     33.745M in   5.033979s
          #end_with?     28.779M (± 0.7%) i/s -    144.964M in   5.037311s

Comparison:
          #end_with?: 28779396.2 i/s
#start_with? (String): 28096504.9 i/s - 1.02x  slower
             #match?: 23230938.9 i/s - 1.24x  slower
                 #=~:  7507625.8 i/s - 3.83x  slower
#start_with? (Regex):  6709898.5 i/s - 4.29x  slower
