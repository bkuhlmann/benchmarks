#! /usr/bin/env ruby
# frozen_string_literal: true

require "bundler/inline"

gemfile true do
  source "https://rubygems.org"

  gem "benchmark-ips"
end

require "securerandom"

word = SecureRandom.alphanumeric 100
string_matcher = "a"
regex_matcher = /\Aa/

Benchmark.ips do |benchmark|
  benchmark.config time: 5, warmup: 2

  benchmark.report("#match?") { word.match? regex_matcher }
  benchmark.report("#=~") { word =~ regex_matcher }
  benchmark.report("#start_with? (String)") { word.start_with? string_matcher }
  benchmark.report("#start_with? (Regex)") { word.start_with? regex_matcher }
  benchmark.report("#end_with?") { word.end_with? string_matcher }

  benchmark.compare!
end

__END__

ruby 4.0.0 (2025-12-25 revision 553f1675f3) +YJIT +PRISM [arm64-darwin25.2.0]
Warming up --------------------------------------
             #match?     2.526M i/100ms
                 #=~     1.339M i/100ms
#start_with? (String)
                         3.002M i/100ms
#start_with? (Regex)     1.048M i/100ms
          #end_with?     3.031M i/100ms
Calculating -------------------------------------
             #match?     28.780M (± 0.1%) i/s   (34.75 ns/i) -    143.989M in   5.003006s
                 #=~     15.506M (± 0.3%) i/s   (64.49 ns/i) -     77.686M in   5.010257s
#start_with? (String)
                         34.909M (± 0.1%) i/s   (28.65 ns/i) -    177.099M in   5.073225s
#start_with? (Regex)     11.312M (± 2.4%) i/s   (88.41 ns/i) -     56.611M in   5.007621s
          #end_with?     35.429M (± 0.1%) i/s   (28.23 ns/i) -    178.822M in   5.047302s

Comparison:
          #end_with?: 35429317.7 i/s
#start_with? (String): 34908613.0 i/s - 1.01x  slower
             #match?: 28780485.2 i/s - 1.23x  slower
                 #=~: 15505538.4 i/s - 2.28x  slower
#start_with? (Regex): 11311568.1 i/s - 3.13x  slower
