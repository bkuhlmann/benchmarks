#! /usr/bin/env ruby
# frozen_string_literal: true

require "bundler/inline"

gemfile true do
  source "https://rubygems.org"

  gem "benchmark-ips"
end

CONSTANTS = Hash.new

module Constants
  1_000.times { |index| CONSTANTS["EXAMPLE_#{index}"] = const_set "EXAMPLE_#{index}", index }
end

Benchmark.ips do |benchmark|
  benchmark.config time: 5, warmup: 2

  benchmark.report("#[]") { CONSTANTS["EXAMPLE_666"] }
  benchmark.report("Module.get (symbol)") { Constants.const_get :EXAMPLE_666 }
  benchmark.report("Module.get (string)") { Constants.const_get "EXAMPLE_666" }
  benchmark.report("Object.get") { Object.const_get "Constants::EXAMPLE_666" }

  benchmark.compare!
end

__END__

ruby 4.0.0 (2025-12-25 revision 553f1675f3) +YJIT +PRISM [arm64-darwin25.2.0]
Warming up --------------------------------------
                 #[]     2.541M i/100ms
 Module.get (symbol)     3.355M i/100ms
 Module.get (string)     1.649M i/100ms
          Object.get   999.683k i/100ms
Calculating -------------------------------------
                 #[]     30.883M (± 0.4%) i/s   (32.38 ns/i) -    155.018M in   5.019618s
 Module.get (symbol)     40.391M (± 0.3%) i/s   (24.76 ns/i) -    204.660M in   5.067003s
 Module.get (string)     18.154M (± 0.6%) i/s   (55.08 ns/i) -     92.351M in   5.087198s
          Object.get     10.796M (± 0.5%) i/s   (92.63 ns/i) -     53.983M in   5.000510s

Comparison:
 Module.get (symbol): 40391128.3 i/s
                 #[]: 30882959.9 i/s - 1.31x  slower
 Module.get (string): 18154323.3 i/s - 2.22x  slower
          Object.get: 10795788.7 i/s - 3.74x  slower
